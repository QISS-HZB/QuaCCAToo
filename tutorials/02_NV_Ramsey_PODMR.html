

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. Energy Levels &mdash; QuaCCAToo  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
    <link rel="shortcut icon" href="../_static/icon.svg"/>
    <link rel="canonical" href="https://qiss-hzb.github.io/quaccatoo/tutorials/02_NV_Ramsey_PODMR.html" />
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="03 - Conditional Gates with NV-13C" href="../tutorial3.html" />
    <link rel="prev" title="02 - Ramsey and PODMR with NV" href="../tutorial2.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            QuaCCAToo
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tutorial1.html">01 - Rabi and Hahn of a Spin Half System</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../tutorial2.html">02 - Ramsey and PODMR with NV</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">1. Energy Levels</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.-Rabi-Oscillations-of-Electronic-Spin">2. Rabi Oscillations of Electronic Spin</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.-Ramsey-Experiment">3. Ramsey Experiment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#3.1-Lab-Frame">3.1 Lab Frame</a></li>
<li class="toctree-l4"><a class="reference internal" href="#3.2-Rotating-Frame">3.2 Rotating Frame</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#4.-Pulsed-Optically-Detected-Magnetic-Resonance-(pODMR)">4. Pulsed Optically Detected Magnetic Resonance (pODMR)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial3.html">03 - Conditional Gates with NV-13C</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial4.html">04 - Sensing and Control of 13C Spin with NV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial5.html">05 - Ambiguous Resonances in DD with NV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial6.html">06 - Teleportation Protocol with NV Pair</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial7.html">07 - Double Electron-Electron Resonace with P1 Center</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial8.html">08 - Multi-Qubit Gates by Dynamical Decoupling with NV</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">QuaCCAToo modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QuaCCAToo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../tutorials.html">Tutorials</a></li>
          <li class="breadcrumb-item"><a href="../tutorial2.html">02 - Ramsey and PODMR with NV</a></li>
      <li class="breadcrumb-item active">1. Energy Levels</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/02_NV_Ramsey_PODMR.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>We follow up on <a class="reference internal" href="01_spin_half_Rabi_Hahn.html"><span class="doc">first</span></a> tutorial, but with a more concrete quantum system: the nitrogen vacancy (NV) center in diamond. NVs are the most known color centers, due to its extensive research in quantum technologies. Here, however, we will focus on QuaCCAToo’s usage rather than the physics of the NV itself. For more detailed information about NVs, we recommend:</p>
<p>[1] E. V. Levine, et al., Principles and techniques of the quantum diamond microscope, Nanophotonics 8, 1945 (2019).</p>
<p>[2] S. Pezzagna and J. Meijer, Quantum computer based on color centers in diamond, Applied Physics Reviews 8,011308 (2021).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">lmfit</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">qutip</span> <span class="kn">import</span> <span class="n">fock_dm</span><span class="p">,</span> <span class="n">tensor</span><span class="p">,</span> <span class="n">qeye</span><span class="p">,</span> <span class="n">jmat</span>

<span class="kn">from</span> <span class="nn">quaccatoo</span> <span class="kn">import</span> <span class="n">plot_energy_B0</span><span class="p">,</span> <span class="n">NV</span><span class="p">,</span> <span class="n">Rabi</span><span class="p">,</span> <span class="n">Ramsey</span><span class="p">,</span> <span class="n">PMR</span><span class="p">,</span> <span class="n">RabiModel</span><span class="p">,</span> <span class="n">fit_two_lorentz_sym</span><span class="p">,</span> <span class="n">fit_two_sinc2_sym</span><span class="p">,</span> <span class="n">Analysis</span><span class="p">,</span> <span class="n">ExpData</span>
</pre></div>
</div>
</div>
<section id="1.-Energy-Levels">
<h1>1. Energy Levels<a class="headerlink" href="#1.-Energy-Levels" title="Link to this heading"></a></h1>
<p>We begin defining the quantum system from the predefined <code class="docutils literal notranslate"><span class="pre">NV</span></code> class in quaccatoo. The class has only two mandatory parameters, the nitrogen isotope <span class="math notranslate nohighlight">\(^{14}\text{N}\)</span>, <span class="math notranslate nohighlight">\(^{15}\text{N}\)</span> or None (which neglects all nuclear terms) and the magnetic field in mT. Optionally, the user can define a misalignment angle between the NV axis and the magnetic field, alternative magnetic field units, alternative Hamiltonian units, or collapse operators for the pulsed experiments. To visualize the
energy levels, we use the <code class="docutils literal notranslate"><span class="pre">plot_energy</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qsys_1</span> <span class="o">=</span> <span class="n">NV</span><span class="p">(</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
    <span class="n">B0</span> <span class="o">=</span> <span class="mf">38.4</span><span class="p">,</span>
    <span class="n">units_B0</span> <span class="o">=</span> <span class="s1">&#39;mT&#39;</span>
<span class="p">)</span>

<span class="n">qsys_1</span><span class="o">.</span><span class="n">plot_energy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_4_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_4_0.png" />
</div>
</div>
<p>We observe the three electronic energy levels of the NV center: <span class="math notranslate nohighlight">\(m_s=0,-1,+1\)</span>. To be able to see the nuclear levels splitting, we need to specify a smaller energy range in the <code class="docutils literal notranslate"><span class="pre">plot_energy</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qsys_1</span><span class="o">.</span><span class="n">plot_energy</span><span class="p">(</span><span class="n">energy_lim</span><span class="o">=</span><span class="p">[</span><span class="mi">1790</span><span class="p">,</span> <span class="mi">1798</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_6_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_6_0.png" />
</div>
</div>
<p>Now, the splitting from the <span class="math notranslate nohighlight">\(^{15}\text{N}\)</span> nuclear spin is observed.</p>
<p>So far we considered <span class="math notranslate nohighlight">\(B_0=38.4\)</span> mT, but if we want to see how these energy levels change as a function of the external magnetic field, we can use the <code class="docutils literal notranslate"><span class="pre">plot_energy_B0</span></code> function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># range of B0 values where we want to plot the energy levels</span>
<span class="n">B0_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">plot_energy_B0</span><span class="p">(</span>
    <span class="n">B0</span> <span class="o">=</span> <span class="n">B0_array</span><span class="p">,</span>
    <span class="c1"># here we calculate the Hamiltonian for each B0 value</span>
    <span class="n">H0</span> <span class="o">=</span> <span class="p">[</span><span class="n">NV</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">B0</span><span class="o">=</span><span class="n">B</span><span class="p">,</span> <span class="n">units_B0</span><span class="o">=</span><span class="s1">&#39;mT&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">H0</span> <span class="k">for</span> <span class="n">B</span> <span class="ow">in</span> <span class="n">B0_array</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_8_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_8_0.png" />
</div>
</div>
<p>As expected, the <span class="math notranslate nohighlight">\(m_s=+1\)</span> grows linearly with the field, while the <span class="math notranslate nohighlight">\(m_s=-1\)</span> decreases linearly and <span class="math notranslate nohighlight">\(m_s=0\)</span> level is not affected by the field. After 100 mT, the level anticrossing occurs.</p>
<p>The energy levels also depend on the temperature, due to slight changes in the Zero-Field term. If the user want to specify a specific temperature, this can be done through the <code class="docutils literal notranslate"><span class="pre">temp</span></code> parameter with temperature units given by <code class="docutils literal notranslate"><span class="pre">units_temp</span></code>, which is by default set to Kelvin.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NV</span><span class="p">(</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span>
    <span class="n">B0</span> <span class="o">=</span> <span class="mf">38.4</span><span class="p">,</span>
    <span class="n">units_B0</span> <span class="o">=</span> <span class="s1">&#39;mT&#39;</span><span class="p">,</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">units_temp</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
<span class="p">)</span><span class="o">.</span><span class="n">plot_energy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_10_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_10_0.png" />
</div>
</div>
<p>Notice that the differece at <span class="math notranslate nohighlight">\(T=3\)</span> K is really small as compared to room temperature. The operational temperature range for this Hamiltonian is between 2.5 K to 700 K.</p>
</section>
<section id="2.-Rabi-Oscillations-of-Electronic-Spin">
<h1>2. Rabi Oscillations of Electronic Spin<a class="headerlink" href="#2.-Rabi-Oscillations-of-Electronic-Spin" title="Link to this heading"></a></h1>
<p>Just like in the previous notebook, the first experiment usually conducted is Rabi oscillations. In this case, <span class="math notranslate nohighlight">\(\hat{h}_1\)</span> and the resonant frequency of the pulse are not as trivial as before. The user can define their own parameters, but the NV class has a standard interaction Hamiltonian</p>
<div class="math notranslate nohighlight">
\[\hat{h}_1 = \hat{S}_x \otimes \mathbb{1},\]</div>
<p>which can be obtained by the <code class="docutils literal notranslate"><span class="pre">MW_h1</span></code> method. While the resonant frequencies for the <span class="math notranslate nohighlight">\(m_s=0 \rightarrow -1\)</span> and <span class="math notranslate nohighlight">\(m_s=0 \rightarrow +1\)</span> can be obtained from <code class="docutils literal notranslate"><span class="pre">MW_freqs</span></code> attribute, which takes the average between the two nuclear spin states. Again, we will consider a square cosine wave for the pulse.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># typical NV Rabi frequency in MHz</span>
<span class="n">w1</span> <span class="o">=</span> <span class="mf">16.72</span>

<span class="n">rabi_sim_1</span> <span class="o">=</span> <span class="n">Rabi</span><span class="p">(</span>
    <span class="c1"># pulse duration in us</span>
    <span class="n">pulse_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">3e-3</span><span class="p">),</span>
    <span class="c1"># NV center system defined above</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_1</span><span class="p">,</span>
    <span class="c1"># control Hamiltonian</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_1</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="c1"># MW frequency for the ms=0 --&gt; ms=-1 state transition</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_1</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
<span class="p">)</span>


<span class="c1"># run the experiment and plot results</span>
<span class="n">rabi_sim_1</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">rabi_analysis_1</span> <span class="o">=</span> <span class="n">Analysis</span><span class="p">(</span><span class="n">rabi_sim_1</span><span class="p">)</span>
<span class="n">rabi_analysis_1</span><span class="o">.</span><span class="n">plot_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_14_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_14_0.png" />
</div>
</div>
<p>If we want to compare with the simulation with experimental data, we can use the <code class="docutils literal notranslate"><span class="pre">ExpData</span></code> class to load it from .dat or .txt file and the <code class="docutils literal notranslate"><span class="pre">compare_with</span></code> method. In this case, the experimental data was measured for the same NV parameters as defined previously.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exp_data</span> <span class="o">=</span> <span class="n">ExpData</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="s1">&#39;./exp_data_tutorials/Ex02_NV_rabi.dat&#39;</span><span class="p">,</span>
                    <span class="n">variable_column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="n">results_columns</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">yerr_columns</span><span class="o">=</span><span class="mi">2</span>
                   <span class="p">)</span>
<span class="c1"># convert the variable from s to us</span>
<span class="n">exp_data</span><span class="o">.</span><span class="n">variable</span> <span class="o">*=</span> <span class="mf">1e6</span>

<span class="n">rabi_analysis_1</span><span class="o">.</span><span class="n">compare_with</span><span class="p">(</span><span class="n">exp_data</span><span class="p">)</span>
<span class="n">rabi_analysis_1</span><span class="o">.</span><span class="n">plot_comparison</span><span class="p">()</span>
<span class="n">rabi_analysis_1</span><span class="o">.</span><span class="n">pearson</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
LinregressResult(slope=np.float64(2.5895433124843423), intercept=np.float64(-2.0453606037750993), rvalue=np.float64(0.9872724331132969), pvalue=np.float64(5.450830010550885e-40), stderr=np.float64(0.060209767213068484), intercept_stderr=np.float64(0.05996996938639089))
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_16_1.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_16_1.png" />
</div>
</div>
<p>We observe a strong correlation of the simulation and experimental data with an rvalue of 0.987. The standard observable for the NV is the population in the <span class="math notranslate nohighlight">\(m_s=0\)</span> given by the fluorescence. To see the populations of the other two states <span class="math notranslate nohighlight">\(m_s=\pm 1\)</span>, we need to redefine the system observables and run again the Rabi experiment.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qsys_1</span><span class="o">.</span><span class="n">observable</span> <span class="o">=</span> <span class="p">[</span><span class="n">tensor</span><span class="p">(</span><span class="n">fock_dm</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">tensor</span><span class="p">(</span><span class="n">fock_dm</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">))]</span>

<span class="c1"># run the experiment</span>
<span class="n">rabi_sim_1</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">rabi_sim_1</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_18_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_18_0.png" />
</div>
</div>
<p>Note that population of the <span class="math notranslate nohighlight">\(m_s=+1\)</span> remains 0, as we are using the <span class="math notranslate nohighlight">\(m_s=0 \rightarrow -1\)</span> resonant frequency, while the <span class="math notranslate nohighlight">\(m_s=-1\)</span> population oscillates with the same frequency as the <span class="math notranslate nohighlight">\(m_s=0\)</span> population, but with opposite sign. If we used the other resonant frequency, the <span class="math notranslate nohighlight">\(m_s=+1\)</span> population would oscillate but <span class="math notranslate nohighlight">\(m_s=-1\)</span> would remain 0.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rabi_sim_2</span> <span class="o">=</span> <span class="n">Rabi</span><span class="p">(</span>
    <span class="n">pulse_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_1</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="c1"># MW frequency for the ms=0 --&gt; ms=+1 state transition</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_1</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
<span class="p">)</span>

<span class="n">rabi_sim_2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">rabi_analysis_2</span> <span class="o">=</span> <span class="n">Analysis</span><span class="p">(</span><span class="n">rabi_sim_2</span><span class="p">)</span>
<span class="n">rabi_analysis_2</span><span class="o">.</span><span class="n">plot_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_20_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_20_0.png" />
</div>
</div>
<p>Finally, by running a fit of the observable we can extract the <span class="math notranslate nohighlight">\(\pi\)</span>-pulse duration.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rabi_analysis_2</span><span class="o">.</span><span class="n">run_fit</span><span class="p">(</span>
    <span class="n">fit_model</span> <span class="o">=</span> <span class="n">RabiModel</span><span class="p">(),</span>
    <span class="c1"># since there are two observables, we need to specify which one we want to fit</span>
    <span class="n">results_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="p">)</span>

<span class="n">rabi_analysis_2</span><span class="o">.</span><span class="n">plot_fit</span><span class="p">()</span>
<span class="n">rabi_analysis_2</span><span class="o">.</span><span class="n">fit_params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<h2>Fit Result</h2> <p>Model: Model(fit_rabi)</p> <table class="jp-toc-ignore"><caption class="jp-toc-ignore">Fit Statistics</caption><tr><td style='text-align:left'>fitting method</td><td style='text-align:right'>leastsq</td></tr><tr><td style='text-align:left'># function evals</td><td style='text-align:right'>26</td></tr><tr><td style='text-align:left'># data points</td><td style='text-align:right'>1000</td></tr><tr><td style='text-align:left'># variables</td><td style='text-align:right'>4</td></tr><tr><td style='text-align:left'>chi-square</td><td style='text-align:right'> 3.3365e-04</td></tr><tr><td style='text-align:left'>reduced chi-square</td><td style='text-align:right'> 3.3499e-07</td></tr><tr><td style='text-align:left'>Akaike info crit.</td><td style='text-align:right'>-14905.1798</td></tr><tr><td style='text-align:left'>Bayesian info crit.</td><td style='text-align:right'>-14885.5488</td></tr><tr><td style='text-align:left'>R-squared</td><td style='text-align:right'> 0.99999731</td></tr></table><table class="jp-toc-ignore"><caption>Parameters</caption><tr><th style='text-align:left'>name</th><th style='text-align:left'>value</th><th style='text-align:left'>standard error</th><th style='text-align:left'>relative error</th><th style='text-align:left'>initial value</th><th style='text-align:left'>min</th><th style='text-align:left'>max</th><th style='text-align:right'>vary</th></tr><tr><td style='text-align:left'>amp</td><td style='text-align:left'> 0.49650660</td><td style='text-align:left'> 2.5932e-05</td><td style='text-align:left'>(0.01%)</td><td style='text-align:left'>0.49757541936557315</td><td style='text-align:left'>       -inf</td><td style='text-align:left'>        inf</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>Tpi</td><td style='text-align:left'> 0.02978212</td><td style='text-align:left'> 3.0015e-07</td><td style='text-align:left'>(0.00%)</td><td style='text-align:left'>0.02993424046055625</td><td style='text-align:left'>       -inf</td><td style='text-align:left'>        inf</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>phi</td><td style='text-align:left'> 3.14178728</td><td style='text-align:left'> 1.0842e-04</td><td style='text-align:left'>(0.00%)</td><td style='text-align:left'>3.4271919857343196</td><td style='text-align:left'>       -inf</td><td style='text-align:left'>        inf</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>offset</td><td style='text-align:left'> 0.49592288</td><td style='text-align:left'> 1.8962e-05</td><td style='text-align:left'>(0.00%)</td><td style='text-align:left'>0.4934025679635617</td><td style='text-align:left'>       -inf</td><td style='text-align:left'>        inf</td><td style='text-align:right'>True</td></tr></table><table class="jp-toc-ignore"><caption>Correlations (unreported values are < 0.100)</caption><tr><th style='text-align:left'>Parameter1</th><th style='text-align:left'>Parameter 2</th><th style='text-align:right'>Correlation</th></tr><tr><td style='text-align:left'>Tpi</td><td style='text-align:left'>phi</td><td style='text-align:right'>+0.8761</td></tr><tr><td style='text-align:left'>Tpi</td><td style='text-align:left'>offset</td><td style='text-align:right'>-0.2614</td></tr><tr><td style='text-align:left'>phi</td><td style='text-align:left'>offset</td><td style='text-align:right'>-0.2291</td></tr></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_22_1.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_22_1.png" />
</div>
</div>
<p>As expected the <span class="math notranslate nohighlight">\(\pi\)</span>-pulse duration is very close to <span class="math notranslate nohighlight">\(1/(2\omega_1)\)</span>.</p>
</section>
<section id="3.-Ramsey-Experiment">
<h1>3. Ramsey Experiment<a class="headerlink" href="#3.-Ramsey-Experiment" title="Link to this heading"></a></h1>
<section id="3.1-Lab-Frame">
<h2>3.1 Lab Frame<a class="headerlink" href="#3.1-Lab-Frame" title="Link to this heading"></a></h2>
<p>A simple, but important, pulse sequence in quantum sensing is the Ramsey experiment. It measures the accumulated phase difference in the two levels, by applying a <span class="math notranslate nohighlight">\(\pi/2\)</span> pulse, waiting for a time <span class="math notranslate nohighlight">\(\tau\)</span> and applying another <span class="math notranslate nohighlight">\(\pi/2\)</span> pulse, then measuring the population in the <span class="math notranslate nohighlight">\(m_s=0\)</span> state.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NV center system same as before with standard observables</span>
<span class="n">qsys_2</span> <span class="o">=</span> <span class="n">NV</span><span class="p">(</span>
    <span class="n">N</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">B0</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
    <span class="n">units_B0</span><span class="o">=</span><span class="s1">&#39;mT&#39;</span>
<span class="p">)</span>

<span class="c1"># Rabi frequency in MHz</span>
<span class="n">w1</span> <span class="o">=</span> <span class="mi">30</span>

<span class="n">ramsey_sim</span> <span class="o">=</span> <span class="n">Ramsey</span><span class="p">(</span>
    <span class="c1"># free evolution time in us</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_2</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_2</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_2</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
<span class="p">)</span>

<span class="n">ramsey_sim</span><span class="o">.</span><span class="n">plot_pulses</span><span class="p">(</span><span class="n">tau</span><span class="o">=</span><span class="mf">.03</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_27_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_27_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ramsey_sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">ramsey_sim</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_28_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_28_0.png" />
</div>
</div>
<p>We could fit the results again with a period oscillation, but to illustrate a different method we will use the FFT from quaccatoo. First, the FFT is run with <code class="docutils literal notranslate"><span class="pre">run_FFT</span></code> method, then the peaks are found with <code class="docutils literal notranslate"><span class="pre">get_peaks_FFT</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ramsey_analysis</span> <span class="o">=</span> <span class="n">Analysis</span><span class="p">(</span><span class="n">ramsey_sim</span><span class="p">)</span>

<span class="n">ramsey_analysis</span><span class="o">.</span><span class="n">run_FFT</span><span class="p">()</span>
<span class="n">ramsey_analysis</span><span class="o">.</span><span class="n">get_peaks_FFT</span><span class="p">()</span>
<span class="n">ramsey_analysis</span><span class="o">.</span><span class="n">plot_FFT</span><span class="p">(</span><span class="n">freq_lim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_30_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_30_0.png" />
</div>
</div>
<p>The frequencies are too spaced in the FFT due to the short range of <span class="math notranslate nohighlight">\(\tau\)</span>, but we can see the main peak corresponds to approximately half of the hyperfine splitting of the nuclear spin <span class="math notranslate nohighlight">\(a_{||}/2=1.515\)</span> MHz, as expected.</p>
</section>
<section id="3.2-Rotating-Frame">
<h2>3.2 Rotating Frame<a class="headerlink" href="#3.2-Rotating-Frame" title="Link to this heading"></a></h2>
<p>Let’s now try to simulate the same sequence with delta pulses through the rotation operator of</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{R}_x = \begin{pmatrix}
1 &amp; 0 \\
0 &amp; \hat{\sigma}_x \\
\end{pmatrix} =
\begin{pmatrix}
1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1\\
0 &amp; 1 &amp; 0
\end{pmatrix},\end{split}\]</div>
<p>which can be obtained through the <code class="docutils literal notranslate"><span class="pre">MW_Rx</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">NV</span></code> class. As in the previous tutorial, the simulation with delta pulses can be defined by setting <code class="docutils literal notranslate"><span class="pre">pi_pulse_duration</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ramsey_delta_sim</span> <span class="o">=</span> <span class="n">Ramsey</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_2</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">Rx</span> <span class="o">=</span> <span class="n">qsys_2</span><span class="o">.</span><span class="n">MW_Rx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">ramsey_delta_sim</span><span class="o">.</span><span class="n">plot_pulses</span><span class="p">(</span><span class="n">tau</span><span class="o">=</span><span class="mf">.03</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_34_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_34_0.png" />
</div>
</div>
<p>In this case then, the delta pulses appear as vertical lines.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ramsey_delta_sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">ramsey_delta_sim</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_36_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_36_0.png" />
</div>
</div>
<p>The expectation value of the observable presents fast modulations, contrary to the previous case. This is because that by adopting delta pulses we are also assuming the rotating frame. Thus, the Hamiltonian <span class="math notranslate nohighlight">\(\hat{H}_0\)</span> needs to be modified accordingly. For that, we make a new quantum system, without the electronic terms and the perpendicular terms of the Hyperfine interaction.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qsys_3</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">qsys_2</span><span class="p">)</span>
<span class="n">qsys_3</span><span class="o">.</span><span class="n">H0</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">3.03</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">(</span><span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">),</span> <span class="n">jmat</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">))</span>
            <span class="o">+</span> <span class="n">qsys_3</span><span class="o">.</span><span class="n">nuclear_zeeman</span><span class="p">()</span>
        <span class="p">)</span>

<span class="n">ramsey_delta_sim_2</span> <span class="o">=</span> <span class="n">Ramsey</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_3</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">Rx</span> <span class="o">=</span> <span class="n">qsys_3</span><span class="o">.</span><span class="n">MW_Rx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">ramsey_delta_sim_2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">ramsey_delta_sim_2</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_38_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_38_0.png" />
</div>
</div>
<p>Where we not obtain the results from the laboratory frame.</p>
</section>
</section>
<section id="4.-Pulsed-Optically-Detected-Magnetic-Resonance-(pODMR)">
<h1>4. Pulsed Optically Detected Magnetic Resonance (pODMR)<a class="headerlink" href="#4.-Pulsed-Optically-Detected-Magnetic-Resonance-(pODMR)" title="Link to this heading"></a></h1>
<p>To further study the energy levels of the system, we simulate a pODMR experiment. A pODMR experiment is simply composed by a pulse of varying frequency, thus when it corresponds to a resonance, a change in the observable is expected.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">podmr_sim_1</span> <span class="o">=</span> <span class="n">PMR</span><span class="p">(</span>
    <span class="c1"># frequencies to scan in MHz</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1400</span><span class="p">,</span> <span class="mi">4300</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_2</span><span class="p">,</span>
    <span class="n">pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_2</span><span class="o">.</span><span class="n">MW_h1</span>
<span class="p">)</span>

<span class="n">podmr_sim_1</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">podmr_sim_1</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_42_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_42_0.png" />
</div>
</div>
<p>Two resonances can be observed, corresponding to the two electronic spin transitions and with a splitting given by the Zeeman interaction with the external magnetic field. To see the nuclear spin splitting, we need to reduce the Rabi frequency to have a better spectral resolution.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w1</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="n">podmr_sim_2</span> <span class="o">=</span> <span class="n">PMR</span><span class="p">(</span>
    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1745</span><span class="p">,</span> <span class="mi">1753</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_2</span><span class="p">,</span>
    <span class="n">pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_2</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">podmr_sim_2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">podmr_sim_2</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_44_0.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_44_0.png" />
</div>
</div>
<p>The two resonances now correspond to the two nuclear spin transitions. To get the splitting, we can fit them with Lorentzian Functions.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">podmr_analysis_1</span> <span class="o">=</span> <span class="n">Analysis</span><span class="p">(</span><span class="n">podmr_sim_2</span><span class="p">)</span>

<span class="n">podmr_analysis_1</span><span class="o">.</span><span class="n">run_fit</span><span class="p">(</span>
    <span class="n">fit_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">fit_two_lorentz_sym</span><span class="p">),</span>
    <span class="c1"># initial guess for the fit parameters</span>
    <span class="n">guess</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;f_mean&#39;</span><span class="p">:</span><span class="mi">1749</span><span class="p">,</span> <span class="s1">&#39;f_delta&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
    <span class="p">)</span>

<span class="n">podmr_analysis_1</span><span class="o">.</span><span class="n">plot_fit</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">podmr_analysis_1</span><span class="o">.</span><span class="n">fit_params</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<h2>Fit Result</h2> <p>Model: Model(fit_two_lorentz_sym)</p> <table class="jp-toc-ignore"><caption class="jp-toc-ignore">Fit Statistics</caption><tr><td style='text-align:left'>fitting method</td><td style='text-align:right'>leastsq</td></tr><tr><td style='text-align:left'># function evals</td><td style='text-align:right'>24</td></tr><tr><td style='text-align:left'># data points</td><td style='text-align:right'>160</td></tr><tr><td style='text-align:left'># variables</td><td style='text-align:right'>5</td></tr><tr><td style='text-align:left'>chi-square</td><td style='text-align:right'> 0.11917074</td></tr><tr><td style='text-align:left'>reduced chi-square</td><td style='text-align:right'> 7.6884e-04</td></tr><tr><td style='text-align:left'>Akaike info crit.</td><td style='text-align:right'>-1142.37949</td></tr><tr><td style='text-align:left'>Bayesian info crit.</td><td style='text-align:right'>-1127.00363</td></tr><tr><td style='text-align:left'>R-squared</td><td style='text-align:right'> 0.95699766</td></tr></table><table class="jp-toc-ignore"><caption>Parameters</caption><tr><th style='text-align:left'>name</th><th style='text-align:left'>value</th><th style='text-align:left'>standard error</th><th style='text-align:left'>relative error</th><th style='text-align:left'>initial value</th><th style='text-align:left'>min</th><th style='text-align:left'>max</th><th style='text-align:right'>vary</th></tr><tr><td style='text-align:left'>A</td><td style='text-align:left'> 0.53979745</td><td style='text-align:left'> 0.01113653</td><td style='text-align:left'>(2.06%)</td><td style='text-align:left'>0.5</td><td style='text-align:left'>       -inf</td><td style='text-align:left'>        inf</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>gamma</td><td style='text-align:left'> 0.19905193</td><td style='text-align:left'> 0.00681276</td><td style='text-align:left'>(3.42%)</td><td style='text-align:left'>0.2</td><td style='text-align:left'>       -inf</td><td style='text-align:left'>        inf</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>f_mean</td><td style='text-align:left'> 1749.00959</td><td style='text-align:left'> 0.00410490</td><td style='text-align:left'>(0.00%)</td><td style='text-align:left'>1749</td><td style='text-align:left'>       -inf</td><td style='text-align:left'>        inf</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>f_delta</td><td style='text-align:left'> 3.02851926</td><td style='text-align:left'> 0.00817442</td><td style='text-align:left'>(0.27%)</td><td style='text-align:left'>3</td><td style='text-align:left'>       -inf</td><td style='text-align:left'>        inf</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>C</td><td style='text-align:left'> 1.00473312</td><td style='text-align:left'> 0.00311801</td><td style='text-align:left'>(0.31%)</td><td style='text-align:left'>1</td><td style='text-align:left'>       -inf</td><td style='text-align:left'>        inf</td><td style='text-align:right'>True</td></tr></table><table class="jp-toc-ignore"><caption>Correlations (unreported values are < 0.100)</caption><tr><th style='text-align:left'>Parameter1</th><th style='text-align:left'>Parameter 2</th><th style='text-align:right'>Correlation</th></tr><tr><td style='text-align:left'>A</td><td style='text-align:left'>gamma</td><td style='text-align:right'>-0.5631</td></tr><tr><td style='text-align:left'>gamma</td><td style='text-align:left'>C</td><td style='text-align:right'>+0.5552</td></tr></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_46_1.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_46_1.png" />
</div>
</div>
<p>From the fit we can extract the parallel component of the hyperfine splitting <span class="math notranslate nohighlight">\(a_{||}^n=3.03\)</span> MHz. However, the commonly used Lorentzian function does not completely describes all features of the resonace. A better fit is provided with a sinc function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">podmr_analysis_2</span> <span class="o">=</span> <span class="n">Analysis</span><span class="p">(</span><span class="n">podmr_sim_2</span><span class="p">)</span>

<span class="n">podmr_analysis_2</span><span class="o">.</span><span class="n">run_fit</span><span class="p">(</span>
    <span class="n">fit_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">fit_two_sinc2_sym</span><span class="p">),</span>
    <span class="n">guess</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s1">&#39;f_mean&#39;</span><span class="p">:</span><span class="mi">1749</span><span class="p">,</span> <span class="s1">&#39;f_delta&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
    <span class="p">)</span>

<span class="n">podmr_analysis_2</span><span class="o">.</span><span class="n">plot_fit</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">podmr_analysis_2</span><span class="o">.</span><span class="n">fit_params</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<h2>Fit Result</h2> <p>Model: Model(fit_two_sinc2_sym)</p> <table class="jp-toc-ignore"><caption class="jp-toc-ignore">Fit Statistics</caption><tr><td style='text-align:left'>fitting method</td><td style='text-align:right'>leastsq</td></tr><tr><td style='text-align:left'># function evals</td><td style='text-align:right'>37</td></tr><tr><td style='text-align:left'># data points</td><td style='text-align:right'>160</td></tr><tr><td style='text-align:left'># variables</td><td style='text-align:right'>5</td></tr><tr><td style='text-align:left'>chi-square</td><td style='text-align:right'> 1.1519e-04</td></tr><tr><td style='text-align:left'>reduced chi-square</td><td style='text-align:right'> 7.4315e-07</td></tr><tr><td style='text-align:left'>Akaike info crit.</td><td style='text-align:right'>-2253.05942</td></tr><tr><td style='text-align:left'>Bayesian info crit.</td><td style='text-align:right'>-2237.68355</td></tr><tr><td style='text-align:left'>R-squared</td><td style='text-align:right'> 0.99995843</td></tr></table><table class="jp-toc-ignore"><caption>Parameters</caption><tr><th style='text-align:left'>name</th><th style='text-align:left'>value</th><th style='text-align:left'>standard error</th><th style='text-align:left'>relative error</th><th style='text-align:left'>initial value</th><th style='text-align:left'>min</th><th style='text-align:left'>max</th><th style='text-align:right'>vary</th></tr><tr><td style='text-align:left'>A</td><td style='text-align:left'> 0.49680377</td><td style='text-align:left'> 2.6730e-04</td><td style='text-align:left'>(0.05%)</td><td style='text-align:left'>0.5</td><td style='text-align:left'>       -inf</td><td style='text-align:left'>        inf</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>gamma</td><td style='text-align:left'> 0.30066414</td><td style='text-align:left'> 1.1410e-04</td><td style='text-align:left'>(0.04%)</td><td style='text-align:left'>0.4</td><td style='text-align:left'>       -inf</td><td style='text-align:left'>        inf</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>f_mean</td><td style='text-align:left'> 1749.00884</td><td style='text-align:left'> 1.2166e-04</td><td style='text-align:left'>(0.00%)</td><td style='text-align:left'>1749</td><td style='text-align:left'>       -inf</td><td style='text-align:left'>        inf</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>f_delta</td><td style='text-align:left'> 3.02839718</td><td style='text-align:left'> 2.4124e-04</td><td style='text-align:left'>(0.01%)</td><td style='text-align:left'>3</td><td style='text-align:left'>       -inf</td><td style='text-align:left'>        inf</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>C</td><td style='text-align:left'> 0.99916985</td><td style='text-align:left'> 8.0476e-05</td><td style='text-align:left'>(0.01%)</td><td style='text-align:left'>1</td><td style='text-align:left'>       -inf</td><td style='text-align:left'>        inf</td><td style='text-align:right'>True</td></tr></table><table class="jp-toc-ignore"><caption>Correlations (unreported values are < 0.100)</caption><tr><th style='text-align:left'>Parameter1</th><th style='text-align:left'>Parameter 2</th><th style='text-align:right'>Correlation</th></tr><tr><td style='text-align:left'>A</td><td style='text-align:left'>C</td><td style='text-align:right'>+0.4124</td></tr><tr><td style='text-align:left'>A</td><td style='text-align:left'>gamma</td><td style='text-align:right'>-0.2688</td></tr><tr><td style='text-align:left'>gamma</td><td style='text-align:left'>C</td><td style='text-align:right'>+0.2126</td></tr></table></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_02_NV_Ramsey_PODMR_48_1.png" src="../_images/tutorials_02_NV_Ramsey_PODMR_48_1.png" />
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../tutorial2.html" class="btn btn-neutral float-left" title="02 - Ramsey and PODMR with NV" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../tutorial3.html" class="btn btn-neutral float-right" title="03 - Conditional Gates with NV-13C" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>