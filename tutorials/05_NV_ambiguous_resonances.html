

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>1. Field Misalignment and \(^{15}\text{N}\) Coupling &mdash; QuaCCAToo  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
    <link rel="canonical" href="https://qiss-hzb.github.io/quaccatoo/tutorials/05_NV_ambiguous_resonances.html" />
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="06 - Teleportation Protocol with NV Pair" href="../notebook6.html" />
    <link rel="prev" title="05 - Ambiguous Resonances in DD with NV" href="../notebook5.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            QuaCCAToo
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../notebook1.html">01 - Rabi and Hahn of a Spin Half System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebook2.html">02 - Ramsey and PODMR with NV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebook3.html">03 - Conditional Gates with NV-13C</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebook4.html">04 - Sensing and Control of 13C Spin with NV</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../notebook5.html">05 - Ambiguous Resonances in DD with NV</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">1. Field Misalignment and <span class="math notranslate nohighlight">\(^{15}\text{N}\)</span> Coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#2.-13C-Coupling">2. 13C Coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#3.-RXY8-with-H2">3. RXY8 with H2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../notebook6.html">06 - Teleportation Protocol with NV Pair</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">QuaCCAToo modules</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">QuaCCAToo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../notebooks.html">Tutorials</a></li>
          <li class="breadcrumb-item"><a href="../notebook5.html">05 - Ambiguous Resonances in DD with NV</a></li>
      <li class="breadcrumb-item active">1. Field Misalignment and <span class="math notranslate nohighlight">\(^{15}\text{N}\)</span> Coupling</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/05_NV_ambiguous_resonances.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>In this example we simulate ambiguous resonances in multipulse quantum sensing with nitrogen vacancy (NV) centers in diamonds. This notebook closely follows the work from “Ambiguous Resonances in Multipulse Quantum Sensing with Nitrogen Vacancy Centers” available at:</p>
<ul class="simple">
<li><ol class="upperalpha simple" start="12">
<li><p>Tsunaki, A. Singh, K. Volkova, S. Trofimov, T. Pregnolato, T. Schröder, &amp; B. Naydenov. (2025). Ambiguous resonances in multipulse quantum sensing with nitrogen-vacancy centers. Physical Review A, 111(2), 022606. doi: <a class="reference external" href="https://journals.aps.org/pra/abstract/10.1103/PhysRevA.111.022606">10.1103/PhysRevA.111.022606</a>.</p></li>
</ol>
</li>
</ul>
<p>As this is a quite complex problem, physics discussions will be kept to a minimum here in favor of a focus to the simulation. For a detailed explanation of the problem, please refer to the original paper.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qutip</span> <span class="kn">import</span> <span class="n">tensor</span><span class="p">,</span> <span class="n">jmat</span><span class="p">,</span> <span class="n">qeye</span>

<span class="kn">from</span> <span class="nn">quaccatoo</span> <span class="kn">import</span> <span class="n">NV</span><span class="p">,</span> <span class="n">XY8</span><span class="p">,</span> <span class="n">Analysis</span>
</pre></div>
</div>
</div>
<section id="1.-Field-Misalignment-and-^{15}\text{N}-Coupling">
<h1>1. Field Misalignment and <span class="math notranslate nohighlight">\(^{15}\text{N}\)</span> Coupling<a class="headerlink" href="#1.-Field-Misalignment-and-^{15}\text{N}-Coupling" title="Link to this heading"></a></h1>
<p>We begin simulating a XY8-2 sequence with a misaligned magnetic field, as in Sec. IV A of the paper. Initially, we define the NV system with the experimental parameters of the paper and the XY8 pulse sequence.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qsys_1</span> <span class="o">=</span> <span class="n">NV</span><span class="p">(</span>
    <span class="n">N</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">B0</span> <span class="o">=</span> <span class="mf">39.4</span><span class="p">,</span>
    <span class="n">units_B0</span><span class="o">=</span><span class="s1">&#39;mT&#39;</span><span class="p">,</span>
    <span class="n">theta</span><span class="o">=</span><span class="mf">2.6</span><span class="p">,</span>
    <span class="n">units_angles</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span>
<span class="p">)</span>

<span class="n">w1</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">XY8_2_15N</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.25</span><span class="p">,</span> <span class="mf">.36</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_1</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_1</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="c1"># MW frequency for the ms=0 --&gt; ms=+1 state transition</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_1</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]},</span>
    <span class="c1"># Number of time steps in each MW pulse</span>
    <span class="n">time_steps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">XY8_2_15N</span><span class="o">.</span><span class="n">plot_pulses</span><span class="p">(</span><span class="n">tau</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_4_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_4_0.png" />
</div>
</div>
<p>This leads to a <span class="math notranslate nohighlight">\(\pi\)</span>-pulse duration shorter than <span class="math notranslate nohighlight">\(1/(2\omega_1)\)</span>, resulting from a hyperfine enhancement effect.</p>
<p>Given the defined system with the experimental parameters, the simplest dynamical decoupling sequence for suppressing the noise from the environment is the Hahn echo technique. The sequence is composed by two free evolutions of duration <span class="math notranslate nohighlight">\(\tau\)</span>, with an intermediate <span class="math notranslate nohighlight">\(\pi\)</span>-pulse to the electron spin. In addition, <span class="math notranslate nohighlight">\(\pi/2\)</span>-pulses are included before and after the sequence to drive the electron spin from and to the quantization axis. In NMR, the last projective pulse is not required
though, as the measurement is performed perpendicular to the quantization axis. The intermediate <span class="math notranslate nohighlight">\(\pi\)</span>-pulse causes a refocusing of static or slow dephasings, such as those arising from the 14N nuclear spin. This allows the coupled 13C nuclear spin to be probed by the NV.</p>
<p>For performing a Hahn echo simulation in the software component, we use the <code class="docutils literal notranslate"><span class="pre">Hahn</span></code> class:</p>
<p>Here we can observe the 16 <span class="math notranslate nohighlight">\(\pi\)</span>-pulses plus the initial and final <span class="math notranslate nohighlight">\(\pi/2\)</span> pulses. Now to run the experiment as in Fig. 3 (d):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XY8_2_15N</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_2_15N</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;XY8-2 $B_0=39$ mT $\theta_0=2.6^\circ$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_7_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_7_0.png" />
</div>
</div>
<p>Increasing the XY8 order. First for <span class="math notranslate nohighlight">\(M=4\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XY8_4_15N</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.25</span><span class="p">,</span> <span class="mf">.36</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_1</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_1</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_1</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]},</span>
<span class="p">)</span>

<span class="n">XY8_4_15N</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_4_15N</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;XY8-4 $B_0=39$ mT $\theta_0=2.6^\circ$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_9_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_9_0.png" />
</div>
</div>
<p><span class="math notranslate nohighlight">\(M=6\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XY8_6_15N</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.25</span><span class="p">,</span> <span class="mf">.36</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_1</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_1</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_1</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]},</span>
<span class="p">)</span>

<span class="n">XY8_6_15N</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_6_15N</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;XY8-6 $B_0=39$ mT $\theta_0=2.6^\circ$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_11_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_11_0.png" />
</div>
</div>
<p><span class="math notranslate nohighlight">\(M=8\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XY8_8_15N</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.25</span><span class="p">,</span> <span class="mf">.36</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_1</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_1</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_1</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]},</span>
<span class="p">)</span>

<span class="n">XY8_8_15N</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_8_15N</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;XY8-8 $B_0=39$ mT $\theta_0=2.6^\circ$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_13_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_13_0.png" />
</div>
</div>
<p>Now, changing the field for XY8-2 as in Fig. 3 (c). First, <span class="math notranslate nohighlight">\(B_0=33\)</span> mT and <span class="math notranslate nohighlight">\(\theta_0 = 5.1^\circ\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qsys_2</span> <span class="o">=</span> <span class="n">NV</span><span class="p">(</span>
    <span class="n">N</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">B0</span> <span class="o">=</span> <span class="mi">33</span><span class="p">,</span>
    <span class="n">units_B0</span><span class="o">=</span><span class="s1">&#39;mT&#39;</span><span class="p">,</span>
    <span class="n">theta</span><span class="o">=</span><span class="mf">5.1</span><span class="p">,</span>
    <span class="n">units_angles</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span>
<span class="p">)</span>

<span class="n">XY8_15N_B1</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.22</span><span class="p">,</span> <span class="mf">.45</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_2</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_2</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_2</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
<span class="p">)</span>

<span class="n">XY8_15N_B1</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_15N_B1</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;XY8-2 $B_0=33$ mT $\theta_0=5.1^\circ$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_15_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_15_0.png" />
</div>
</div>
<p><span class="math notranslate nohighlight">\(B_0=26\)</span> mT and <span class="math notranslate nohighlight">\(\theta_0 = 9.3^\circ\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qsys_3</span> <span class="o">=</span> <span class="n">NV</span><span class="p">(</span>
    <span class="n">N</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">B0</span> <span class="o">=</span> <span class="mi">26</span><span class="p">,</span>
    <span class="n">units_B0</span><span class="o">=</span><span class="s1">&#39;mT&#39;</span><span class="p">,</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="mf">9.3</span><span class="p">,</span>
    <span class="n">units_angles</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span>
<span class="p">)</span>

<span class="n">XY8_15N_B2</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.22</span><span class="p">,</span> <span class="mf">.45</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_3</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_3</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_3</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
<span class="p">)</span>

<span class="n">XY8_15N_B2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_15N_B2</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;XY8-2 $B_0=26$ mT $\theta_0=9.3^\circ$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_17_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_17_0.png" />
</div>
</div>
<p><span class="math notranslate nohighlight">\(B_0=17\)</span> mT and <span class="math notranslate nohighlight">\(\theta_0 = 17^\circ\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qsys_4</span> <span class="o">=</span> <span class="n">NV</span><span class="p">(</span>
    <span class="n">N</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">B0</span> <span class="o">=</span> <span class="mi">17</span><span class="p">,</span>
    <span class="n">units_B0</span><span class="o">=</span><span class="s1">&#39;mT&#39;</span><span class="p">,</span>
    <span class="n">theta</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span>
    <span class="n">units_angles</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span>
<span class="p">)</span>

<span class="n">XY8_15N_B3</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.25</span><span class="p">,</span> <span class="mf">.45</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_4</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_4</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_4</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
<span class="p">)</span>

<span class="n">XY8_15N_B3</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_15N_B3</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;XY8-2 $B_0=17$ mT $\theta_0=17^\circ$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_19_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_19_0.png" />
</div>
</div>
<p>If we now include a pulse length error, as in Fig. 6, we have:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XY8_15N_B3_errors</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.25</span><span class="p">,</span> <span class="mf">.45</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_4</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="o">*</span><span class="mf">.8</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_4</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_4</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
<span class="p">)</span>

<span class="n">XY8_15N_B3_errors</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_15N_B3_errors</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;XY8-2 $B_0=17$ mT $\theta_0=17^\circ$, pulse lenght=0.8 $t_{\pi}$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_21_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_21_0.png" />
</div>
</div>
</section>
<section id="2.-13C-Coupling">
<h1>2. 13C Coupling<a class="headerlink" href="#2.-13C-Coupling" title="Link to this heading"></a></h1>
<p>As in Sec. IV B, we need to define the coupling Hamiltonian <span class="math notranslate nohighlight">\(\hat{H}_2\)</span> in the same way as Eq. 3 of the paper. We begin defining the coupling tensor shown in Appendix D and the Zeeman Hamiltonian.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
<span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.25</span>
<span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.85</span>
<span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">.49</span>
<span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.01</span>
<span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.01</span>

<span class="n">HhfC</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">tensor</span><span class="p">(</span><span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">tensor</span><span class="p">(</span><span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">tensor</span><span class="p">(</span><span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">tensor</span><span class="p">(</span><span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">tensor</span><span class="p">(</span><span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">tensor</span><span class="p">(</span><span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">tensor</span><span class="p">(</span><span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>  <span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">tensor</span><span class="p">(</span><span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">tensor</span><span class="p">(</span><span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">))</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">Hzc</span><span class="p">(</span><span class="n">B0</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">10.705e-3</span><span class="o">*</span><span class="n">B0</span><span class="o">*</span><span class="n">tensor</span><span class="p">(</span><span class="n">qeye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">*</span><span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">*</span><span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Now we define the NV Hamiltonian and use the <code class="docutils literal notranslate"><span class="pre">add_spin</span></code> method to introduce the 13C nuclear spin.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qsys_5</span> <span class="o">=</span> <span class="n">NV</span><span class="p">(</span>
    <span class="n">N</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
    <span class="n">B0</span> <span class="o">=</span> <span class="mi">18</span><span class="p">,</span>
    <span class="n">units_B0</span><span class="o">=</span><span class="s1">&#39;mT&#39;</span><span class="p">,</span>
    <span class="n">theta</span><span class="o">=</span><span class="mf">2.34</span><span class="p">,</span>
    <span class="n">units_angles</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">qsys_5</span><span class="o">.</span><span class="n">add_spin</span><span class="p">(</span><span class="n">HhfC</span> <span class="o">+</span> <span class="n">Hzc</span><span class="p">(</span><span class="n">qsys_5</span><span class="o">.</span><span class="n">B0</span><span class="p">,</span> <span class="n">qsys_5</span><span class="o">.</span><span class="n">theta</span><span class="p">))</span>

<span class="n">XY8_13C_B1</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mf">.85</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_5</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_5</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_5</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
<span class="p">)</span>

<span class="n">XY8_13C_B1</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_13C_B1</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;XY8-2 $^</span><span class="si">{13}</span><span class="s1">$C, $B_0=18$ mT, $\theta_0=2.34^\circ$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_26_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_26_0.png" />
</div>
</div>
<p>Increasing the field as in Fig. 4 (a) for <span class="math notranslate nohighlight">\(B_0=31\)</span> mT and <span class="math notranslate nohighlight">\(\theta_0 = 1.35^\circ\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qsys_6</span> <span class="o">=</span> <span class="n">NV</span><span class="p">(</span>
    <span class="n">N</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
    <span class="n">B0</span> <span class="o">=</span> <span class="mi">31</span><span class="p">,</span>
    <span class="n">units_B0</span><span class="o">=</span><span class="s1">&#39;mT&#39;</span><span class="p">,</span>
    <span class="n">theta</span><span class="o">=</span><span class="mf">1.35</span><span class="p">,</span>
    <span class="n">units_angles</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">qsys_6</span><span class="o">.</span><span class="n">add_spin</span><span class="p">(</span><span class="n">HhfC</span> <span class="o">+</span> <span class="n">Hzc</span><span class="p">(</span><span class="n">qsys_6</span><span class="o">.</span><span class="n">B0</span><span class="p">,</span> <span class="n">qsys_6</span><span class="o">.</span><span class="n">theta</span><span class="p">))</span>

<span class="n">XY8_13C_B2</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mf">.85</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_6</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_6</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_6</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
<span class="p">)</span>

<span class="n">XY8_13C_B2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_13C_B2</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;XY8-2 $^</span><span class="si">{13}</span><span class="s1">$C, $B_0=31$ mT, $\theta_0=1.35^\circ$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_28_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_28_0.png" />
</div>
</div>
<p><span class="math notranslate nohighlight">\(B_0=40\)</span> mT and <span class="math notranslate nohighlight">\(\theta_0 = 1.14^\circ\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qsys_7</span> <span class="o">=</span> <span class="n">NV</span><span class="p">(</span>
    <span class="n">N</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
    <span class="n">B0</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
    <span class="n">units_B0</span><span class="o">=</span><span class="s1">&#39;mT&#39;</span><span class="p">,</span>
    <span class="n">theta</span><span class="o">=</span><span class="mf">1.14</span><span class="p">,</span>
    <span class="n">units_angles</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">qsys_7</span><span class="o">.</span><span class="n">add_spin</span><span class="p">(</span><span class="n">HhfC</span> <span class="o">+</span> <span class="n">Hzc</span><span class="p">(</span><span class="n">qsys_7</span><span class="o">.</span><span class="n">B0</span><span class="p">,</span> <span class="n">qsys_7</span><span class="o">.</span><span class="n">theta</span><span class="p">))</span>

<span class="n">XY8_13C_B3</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mf">.85</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_7</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_7</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_7</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
<span class="p">)</span>

<span class="n">XY8_13C_B3</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_13C_B3</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;XY8-2 $^</span><span class="si">{13}</span><span class="s1">$C, $B_0=40$ mT, $\theta_0=1.14^\circ$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_30_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_30_0.png" />
</div>
</div>
<p>Now, we keep the field constant and increase the order, as in Fig. 4(b). <span class="math notranslate nohighlight">\(M=4\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XY8_4_13C</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mf">.85</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_7</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_7</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_7</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
<span class="p">)</span>

<span class="n">XY8_4_13C</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_4_13C</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;XY8-4 $^</span><span class="si">{13}</span><span class="s1">$C, $B_0=40$ mT, $\theta_0=1.14^\circ$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_32_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_32_0.png" />
</div>
</div>
<p><span class="math notranslate nohighlight">\(M=6\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XY8_6_13C</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mf">.85</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_7</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_7</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_7</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
<span class="p">)</span>

<span class="n">XY8_6_13C</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_6_13C</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;XY8-6 $^</span><span class="si">{13}</span><span class="s1">$C, $B_0=40$ mT, $\theta_0=1.14^\circ$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_34_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_34_0.png" />
</div>
</div>
<p><span class="math notranslate nohighlight">\(M=8\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XY8_8_13C</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.4</span><span class="p">,</span> <span class="mf">.85</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_7</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_7</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_7</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
<span class="p">)</span>

<span class="n">XY8_8_13C</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_8_13C</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;XY8-8 $^</span><span class="si">{13}</span><span class="s1">$C, $B_0=40$ mT, $\theta_0=1.14^\circ$&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_36_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_36_0.png" />
</div>
</div>
</section>
<section id="3.-RXY8-with-H2">
<h1>3. RXY8 with H2<a class="headerlink" href="#3.-RXY8-with-H2" title="Link to this heading"></a></h1>
<p>As discussed in Sec. IV C, the finite length of the pulses can lead to ambiguous resonances. Here, we define the NV Hamiltonian as usual and a time-dependent magnetic field <span class="math notranslate nohighlight">\(B_2(t)\)</span> as in Eq. 4.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qsys_8</span> <span class="o">=</span> <span class="n">NV</span><span class="p">(</span>
    <span class="n">N</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">B0</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>
    <span class="n">units_B0</span><span class="o">=</span><span class="s1">&#39;mT&#39;</span>
<span class="p">)</span>

<span class="n">w1</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">f2</span> <span class="o">=</span> <span class="mf">5.5</span>
<span class="n">B2z</span> <span class="o">=</span> <span class="mf">0.3</span>

<span class="k">def</span> <span class="nf">B2</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">B2z</span><span class="o">=</span><span class="n">B2z</span><span class="p">,</span> <span class="n">f2</span><span class="o">=</span><span class="n">f2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">B2z</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">f2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="n">H2</span> <span class="o">=</span> <span class="p">[</span><span class="n">tensor</span><span class="p">(</span><span class="n">jmat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">),</span> <span class="n">qeye</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="n">B2</span><span class="p">]</span>

<span class="n">XY8_12_H2</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.06</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_8</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_8</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_8</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">]},</span>
    <span class="n">H2</span> <span class="o">=</span> <span class="n">H2</span>
<span class="p">)</span>

<span class="c1"># the number of CPUs for the parallel computation can be specified with the num_cpus keyword argument</span>
<span class="n">XY8_12_H2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_12_H2</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_39_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_39_0.png" />
</div>
</div>
<p>To show that these resonances are indeed from the finite pulse duration, we now simulate it with delta pulses.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XY8_12_H2_delta</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.06</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_8</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">Rx</span> <span class="o">=</span> <span class="n">qsys_8</span><span class="o">.</span><span class="n">MW_Rx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">Ry</span> <span class="o">=</span> <span class="n">qsys_8</span><span class="o">.</span><span class="n">MW_Ry</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">H2</span> <span class="o">=</span> <span class="n">H2</span>
<span class="p">)</span>

<span class="n">XY8_12_H2_delta</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">XY8_12_H2_delta</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_41_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_41_0.png" />
</div>
</div>
<p>These ambiguous resonances can be supressed with phase randomization, for that we use the XY8 class with the RXY8 parameter set to True.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">RXY8_12_H2</span>  <span class="o">=</span> <span class="n">XY8</span><span class="p">(</span>
    <span class="n">free_duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.06</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">qsys_8</span><span class="p">,</span>
    <span class="n">M</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
    <span class="n">pi_pulse_duration</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="n">w1</span><span class="p">,</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="n">w1</span><span class="o">*</span><span class="n">qsys_8</span><span class="o">.</span><span class="n">MW_h1</span><span class="p">,</span>
    <span class="n">pulse_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;f_pulse&#39;</span><span class="p">:</span> <span class="n">qsys_8</span><span class="o">.</span><span class="n">MW_freqs</span><span class="p">[</span><span class="mi">0</span><span class="p">]},</span>
    <span class="n">H2</span> <span class="o">=</span> <span class="n">H2</span><span class="p">,</span>
    <span class="n">RXY8</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">RXY8_12_H2</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">Analysis</span><span class="p">(</span><span class="n">RXY8_12_H2</span><span class="p">)</span><span class="o">.</span><span class="n">plot_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_05_NV_ambiguous_resonances_43_0.png" src="../_images/tutorials_05_NV_ambiguous_resonances_43_0.png" />
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../notebook5.html" class="btn btn-neutral float-left" title="05 - Ambiguous Resonances in DD with NV" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../notebook6.html" class="btn btn-neutral float-right" title="06 - Teleportation Protocol with NV Pair" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Lucas Tsunaki, Anmol Singh, Sergei Trofimov.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>